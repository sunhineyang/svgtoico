# å¤šè¯­è¨€æ‰©å±•æŠ€æœ¯æ¶æ„æ–‡æ¡£

## 1. æ¶æ„è®¾è®¡

```mermaid
graph TD
    A[ç”¨æˆ·æµè§ˆå™¨] --> B[Next.js ä¸­é—´ä»¶]
    B --> C[è¯­è¨€æ£€æµ‹ä¸è·¯ç”±]
    C --> D[åŠ¨æ€è·¯ç”± [locale]]
    D --> E[é¡µé¢ç»„ä»¶]
    E --> F[next-intl Hook]
    F --> G[ç¿»è¯‘æ–‡ä»¶åŠ è½½]
    G --> H[æ¸²æŸ“å¤šè¯­è¨€å†…å®¹]
    
    I[è¯­è¨€åˆ‡æ¢ç»„ä»¶] --> J[URLé‡å®šå‘]
    J --> B
    
    subgraph "å‰ç«¯å±‚"
        A
        I
        E
    end
    
    subgraph "è·¯ç”±å±‚"
        B
        C
        D
    end
    
    subgraph "å›½é™…åŒ–å±‚"
        F
        G
        H
    end
    
    subgraph "ç¿»è¯‘èµ„æº"
        K[messages/en.json]
        L[messages/ru.json]
        M[messages/ko.json - æ–°å¢]
        N[messages/ja.json - æ–°å¢]
    end
    
    G --> K
    G --> L
    G --> M
    G --> N
```

## 2. æŠ€æœ¯æè¿°

- **å‰ç«¯**: Next.js 14 + React 18 + TypeScript + Tailwind CSS
- **å›½é™…åŒ–**: next-intl + åŠ¨æ€è·¯ç”±
- **è·¯ç”±**: App Router + ä¸­é—´ä»¶å¤„ç†
- **çŠ¶æ€ç®¡ç†**: React Hooks + æœ¬åœ°çŠ¶æ€

## 3. è·¯ç”±å®šä¹‰

### 3.1 å½“å‰è·¯ç”±ç»“æ„
| è·¯ç”± | è¯­è¨€ | ç”¨é€” |
|------|------|------|
| / | è‹±è¯­(é»˜è®¤) | ä¸»é¡µé¢ï¼ŒSVGè½¬ICOå·¥å…· |
| /ru | ä¿„è¯­ | ä¿„è¯­ç‰ˆæœ¬ä¸»é¡µé¢ |

### 3.2 æ‰©å±•åè·¯ç”±ç»“æ„
| è·¯ç”± | è¯­è¨€ | ç”¨é€” |
|------|------|------|
| / | è‹±è¯­(é»˜è®¤) | ä¸»é¡µé¢ï¼ŒSVGè½¬ICOå·¥å…· |
| /ru | ä¿„è¯­ | ä¿„è¯­ç‰ˆæœ¬ä¸»é¡µé¢ |
| /ko | éŸ©è¯­ | éŸ©è¯­ç‰ˆæœ¬ä¸»é¡µé¢ |
| /ja | æ—¥è¯­ | æ—¥è¯­ç‰ˆæœ¬ä¸»é¡µé¢ |

## 4. APIå®šä¹‰

### 4.1 æ ¸å¿ƒå›½é™…åŒ–API

#### è¯­è¨€æ£€æµ‹API
```typescript
// è·å–å½“å‰è¯­è¨€ç¯å¢ƒ
const locale = useLocale();
// è¿”å›: 'en' | 'ru' | 'ko' | 'ja'
```

#### ç¿»è¯‘API
```typescript
// è·å–ç¿»è¯‘å‡½æ•°
const t = useTranslations('namespace');
// ä½¿ç”¨: t('key') è¿”å›å¯¹åº”è¯­è¨€çš„ç¿»è¯‘æ–‡æœ¬
```

#### è·¯ç”±API
```typescript
// è·å–è·¯ç”±ä¿¡æ¯
const router = useRouter();
const pathname = usePathname();
```

### 4.2 è¯­è¨€åˆ‡æ¢API

#### è¯­è¨€åˆ‡æ¢å‡½æ•°
```typescript
interface LanguageChangeParams {
  targetLanguage: string;  // ç›®æ ‡è¯­è¨€ä»£ç 
  currentUrl: string;      // å½“å‰é¡µé¢URL
}

interface LanguageChangeResponse {
  success: boolean;        // åˆ‡æ¢æ˜¯å¦æˆåŠŸ
  targetUrl: string;       // ç›®æ ‡é¡µé¢URL
  error?: string;          // é”™è¯¯ä¿¡æ¯(å¦‚æœæœ‰)
}

// è¯­è¨€åˆ‡æ¢å¤„ç†
function handleLanguageChange(params: LanguageChangeParams): LanguageChangeResponse
```

è¯·æ±‚å‚æ•°:
| å‚æ•°å | å‚æ•°ç±»å‹ | æ˜¯å¦å¿…éœ€ | æè¿° |
|--------|----------|----------|------|
| targetLanguage | string | true | ç›®æ ‡è¯­è¨€ä»£ç  (en/ru/ko/ja) |
| currentUrl | string | true | å½“å‰é¡µé¢å®Œæ•´URL |

å“åº”å‚æ•°:
| å‚æ•°å | å‚æ•°ç±»å‹ | æè¿° |
|--------|----------|------|
| success | boolean | åˆ‡æ¢æ“ä½œæ˜¯å¦æˆåŠŸ |
| targetUrl | string | é‡å®šå‘çš„ç›®æ ‡URL |
| error | string? | é”™è¯¯ä¿¡æ¯(å¯é€‰) |

ç¤ºä¾‹:
```json
{
  "targetLanguage": "ko",
  "currentUrl": "https://domain.com/ru"
}
```

å“åº”:
```json
{
  "success": true,
  "targetUrl": "https://domain.com/ko"
}
```

## 5. æœåŠ¡æ¶æ„å›¾

```mermaid
graph TD
    A[å®¢æˆ·ç«¯è¯·æ±‚] --> B[Next.js ä¸­é—´ä»¶å±‚]
    B --> C[è¯­è¨€æ£€æµ‹æœåŠ¡]
    C --> D[è·¯ç”±é‡å†™æœåŠ¡]
    D --> E[é¡µé¢æ¸²æŸ“å±‚]
    E --> F[å›½é™…åŒ–æœåŠ¡å±‚]
    F --> G[ç¿»è¯‘èµ„æºå±‚]
    
    subgraph "ä¸­é—´ä»¶å±‚"
        B
        C
        D
    end
    
    subgraph "åº”ç”¨å±‚"
        E
        F
    end
    
    subgraph "æ•°æ®å±‚"
        G
        H[é™æ€ç¿»è¯‘æ–‡ä»¶]
    end
    
    G --> H
```

## 6. æ•°æ®æ¨¡å‹

### 6.1 æ•°æ®æ¨¡å‹å®šä¹‰

```mermaid
erDiagram
    LOCALE ||--o{ TRANSLATION_FILE : contains
    TRANSLATION_FILE ||--o{ TRANSLATION_KEY : includes
    TRANSLATION_KEY ||--o{ TRANSLATION_VALUE : has
    
    LOCALE {
        string code PK
        string name
        string flag
        boolean isDefault
    }
    
    TRANSLATION_FILE {
        string locale FK
        string namespace
        string filePath
        date lastModified
    }
    
    TRANSLATION_KEY {
        string namespace FK
        string keyPath
        string description
    }
    
    TRANSLATION_VALUE {
        string keyPath FK
        string locale FK
        string value
        string context
    }
```

### 6.2 æ•°æ®å®šä¹‰è¯­è¨€

#### è¯­è¨€ç¯å¢ƒé…ç½®
```typescript
// è¯­è¨€ç¯å¢ƒå®šä¹‰
interface LocaleConfig {
  code: string;           // è¯­è¨€ä»£ç  (ISO 639-1)
  name: string;           // è¯­è¨€æ˜¾ç¤ºåç§°
  flag: string;           // æ——å¸œemoji
  isDefault: boolean;     // æ˜¯å¦ä¸ºé»˜è®¤è¯­è¨€
  direction: 'ltr' | 'rtl'; // æ–‡å­—æ–¹å‘
}

// å½“å‰é…ç½®
const locales: LocaleConfig[] = [
  { code: 'en', name: 'English', flag: 'ğŸ‡ºğŸ‡¸', isDefault: true, direction: 'ltr' },
  { code: 'ru', name: 'Ğ ÑƒÑÑĞºĞ¸Ğ¹', flag: 'ğŸ‡·ğŸ‡º', isDefault: false, direction: 'ltr' }
];

// æ‰©å±•åé…ç½®
const locales: LocaleConfig[] = [
  { code: 'en', name: 'English', flag: 'ğŸ‡ºğŸ‡¸', isDefault: true, direction: 'ltr' },
  { code: 'ru', name: 'Ğ ÑƒÑÑĞºĞ¸Ğ¹', flag: 'ğŸ‡·ğŸ‡º', isDefault: false, direction: 'ltr' },
  { code: 'ko', name: 'í•œêµ­ì–´', flag: 'ğŸ‡°ğŸ‡·', isDefault: false, direction: 'ltr' },
  { code: 'ja', name: 'æ—¥æœ¬èª', flag: 'ğŸ‡¯ğŸ‡µ', isDefault: false, direction: 'ltr' }
];
```

#### ç¿»è¯‘æ–‡ä»¶ç»“æ„
```typescript
// ç¿»è¯‘æ–‡ä»¶æ¥å£å®šä¹‰
interface TranslationMessages {
  common: {
    language: string;
    home: string;
    features: string;
    pricing: string;
    about: string;
    contact: string;
  };
  nav: {
    features: string;
    pricing: string;
    faq: string;
    contact: string;
  };
  hero: {
    title: string;
    subtitle: string;
    description: string;
    uploadButton: string;
    dragDrop: string;
  };
  converter: {
    title: string;
    selectFile: string;
    processing: string;
    download: string;
    reset: string;
  };
  features: {
    title: string;
    items: Array<{
      title: string;
      description: string;
    }>;
  };
  footer: {
    copyright: string;
    privacy: string;
    terms: string;
  };
}
```

#### è·¯ç”±é…ç½®
```typescript
// è·¯ç”±é…ç½®å®šä¹‰
interface RoutingConfig {
  locales: string[];           // æ”¯æŒçš„è¯­è¨€åˆ—è¡¨
  defaultLocale: string;       // é»˜è®¤è¯­è¨€
  localePrefix: 'always' | 'as-needed' | 'never'; // URLå‰ç¼€ç­–ç•¥
  pathnames: Record<string, string | Record<string, string>>; // è·¯å¾„åæ˜ å°„
}

// å½“å‰è·¯ç”±é…ç½®
const routing: RoutingConfig = {
  locales: ['en', 'ru'],
  defaultLocale: 'en',
  localePrefix: 'never',
  pathnames: {
    '/': '/',
    '/about': {
      en: '/about',
      ru: '/o-nas'
    }
  }
};

// æ‰©å±•åè·¯ç”±é…ç½®
const routing: RoutingConfig = {
  locales: ['en', 'ru', 'ko', 'ja'],
  defaultLocale: 'en',
  localePrefix: 'never',
  pathnames: {
    '/': '/',
    '/about': {
      en: '/about',
      ru: '/o-nas',
      ko: '/about',  // éŸ©è¯­ä¿æŒè‹±æ–‡è·¯å¾„
      ja: '/about'   // æ—¥è¯­ä¿æŒè‹±æ–‡è·¯å¾„
    }
  }
};
```

#### ä¸­é—´ä»¶é…ç½®
```typescript
// ä¸­é—´ä»¶åŒ¹é…è§„åˆ™
interface MiddlewareConfig {
  matcher: string[];  // è·¯å¾„åŒ¹é…è§„åˆ™
}

// å½“å‰ä¸­é—´ä»¶é…ç½®
const config: MiddlewareConfig = {
  matcher: [
    '/((?!api|_next/static|_next/image|favicon.ico).*)',
    '/',
    '/(ru|en)/:path*'
  ]
};

// æ‰©å±•åä¸­é—´ä»¶é…ç½®
const config: MiddlewareConfig = {
  matcher: [
    '/((?!api|_next/static|_next/image|favicon.ico).*)',
    '/',
    '/(ru|en|ko|ja)/:path*'  // æ·»åŠ éŸ©è¯­å’Œæ—¥è¯­æ”¯æŒ
  ]
};
```

## 7. å®æ–½è®¡åˆ’

### 7.1 ç¬¬ä¸€é˜¶æ®µï¼šé…ç½®æ›´æ–°
**é¢„è®¡æ—¶é—´**: 2å°æ—¶

1. **æ›´æ–°è·¯ç”±é…ç½®** (`src/i18n/routing.ts`)
   - æ·»åŠ  'ko', 'ja' åˆ° locales æ•°ç»„
   - éªŒè¯é…ç½®è¯­æ³•æ­£ç¡®æ€§

2. **æ›´æ–°ä¸­é—´ä»¶é…ç½®** (`middleware.ts`)
   - ä¿®æ”¹ matcher è§„åˆ™åŒ…å«æ–°è¯­è¨€
   - æµ‹è¯•è·¯ç”±åŒ¹é…åŠŸèƒ½

### 7.2 ç¬¬äºŒé˜¶æ®µï¼šç»„ä»¶æ›´æ–°
**é¢„è®¡æ—¶é—´**: 1å°æ—¶

1. **æ›´æ–°è¯­è¨€åˆ‡æ¢ç»„ä»¶** (`src/components/common/language-toggle.tsx`)
   - æ·»åŠ éŸ©è¯­å’Œæ—¥è¯­åˆ° languages æ•°ç»„
   - æµ‹è¯•UIæ˜¾ç¤ºæ•ˆæœ
   - éªŒè¯åˆ‡æ¢é€»è¾‘æ­£ç¡®æ€§

### 7.3 ç¬¬ä¸‰é˜¶æ®µï¼šç¿»è¯‘æ–‡ä»¶åˆ›å»º
**é¢„è®¡æ—¶é—´**: 4-8å°æ—¶(å–å†³äºç¿»è¯‘è´¨é‡è¦æ±‚)

1. **åˆ›å»ºéŸ©è¯­ç¿»è¯‘æ–‡ä»¶** (`messages/ko.json`)
   - å¤åˆ¶è‹±è¯­æ–‡ä»¶ç»“æ„
   - ç¿»è¯‘æ‰€æœ‰æ–‡æœ¬å†…å®¹
   - æ–‡åŒ–é€‚åº”æ€§è°ƒæ•´

2. **åˆ›å»ºæ—¥è¯­ç¿»è¯‘æ–‡ä»¶** (`messages/ja.json`)
   - å¤åˆ¶è‹±è¯­æ–‡ä»¶ç»“æ„
   - ç¿»è¯‘æ‰€æœ‰æ–‡æœ¬å†…å®¹
   - æ•¬è¯­å’Œæ–‡åŒ–é€‚åº”æ€§è°ƒæ•´

### 7.4 ç¬¬å››é˜¶æ®µï¼šæµ‹è¯•éªŒè¯
**é¢„è®¡æ—¶é—´**: 2-3å°æ—¶

1. **åŠŸèƒ½æµ‹è¯•**
   - è¯­è¨€åˆ‡æ¢åŠŸèƒ½æµ‹è¯•
   - URLè·¯ç”±æ­£ç¡®æ€§éªŒè¯
   - ç¿»è¯‘å†…å®¹æ˜¾ç¤ºæµ‹è¯•

2. **å…¼å®¹æ€§æµ‹è¯•**
   - ç°æœ‰åŠŸèƒ½å›å½’æµ‹è¯•
   - è·¨æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•
   - å“åº”å¼è®¾è®¡æµ‹è¯•

3. **æ€§èƒ½æµ‹è¯•**
   - é¡µé¢åŠ è½½é€Ÿåº¦æµ‹è¯•
   - ç¿»è¯‘æ–‡ä»¶åŠ è½½æ•ˆç‡æµ‹è¯•
   - è¯­è¨€åˆ‡æ¢å“åº”æ—¶é—´æµ‹è¯•

## 8. è´¨é‡ä¿è¯

### 8.1 ä»£ç è´¨é‡
- TypeScript ç±»å‹æ£€æŸ¥
- ESLint ä»£ç è§„èŒƒæ£€æŸ¥
- ç»„ä»¶å•å…ƒæµ‹è¯•
- é›†æˆæµ‹è¯•è¦†ç›–

### 8.2 ç¿»è¯‘è´¨é‡
- ä¸“ä¸šç¿»è¯‘äººå‘˜å®¡æ ¸
- æ¯è¯­ä½¿ç”¨è€…æ ¡å¯¹
- æ–‡åŒ–é€‚åº”æ€§è¯„ä¼°
- æœ¯è¯­ä¸€è‡´æ€§æ£€æŸ¥

### 8.3 ç”¨æˆ·ä½“éªŒ
- è¯­è¨€åˆ‡æ¢æµç•…æ€§
- UIå…ƒç´ é€‚é…æ€§
- æ–‡æœ¬é•¿åº¦é€‚åº”
- æ–‡åŒ–æ•æ„Ÿæ€§è€ƒè™‘

## 9. éƒ¨ç½²å’Œç›‘æ§

### 9.1 éƒ¨ç½²ç­–ç•¥
- æ¸è¿›å¼éƒ¨ç½²
- A/Bæµ‹è¯•æ”¯æŒ
- å›æ»šæœºåˆ¶å‡†å¤‡
- ç¼“å­˜æ¸…ç†ç­–ç•¥

### 9.2 ç›‘æ§æŒ‡æ ‡
- è¯­è¨€ä½¿ç”¨åˆ†å¸ƒç»Ÿè®¡
- é¡µé¢åŠ è½½æ€§èƒ½ç›‘æ§
- é”™è¯¯ç‡ç›‘æ§
- ç”¨æˆ·è¡Œä¸ºåˆ†æ

## 10. ç»´æŠ¤å’Œæ‰©å±•

### 10.1 æ—¥å¸¸ç»´æŠ¤
- ç¿»è¯‘å†…å®¹æ›´æ–°æµç¨‹
- æ–°åŠŸèƒ½å¤šè¯­è¨€æ”¯æŒ
- å®šæœŸè´¨é‡æ£€æŸ¥
- ç”¨æˆ·åé¦ˆå¤„ç†

### 10.2 æœªæ¥æ‰©å±•
- æ›´å¤šè¯­è¨€æ”¯æŒå‡†å¤‡
- åŠ¨æ€ç¿»è¯‘åŠ è½½
- ç¿»è¯‘ç®¡ç†ç³»ç»Ÿé›†æˆ
- è‡ªåŠ¨åŒ–ç¿»è¯‘å·¥å…·é›†æˆ